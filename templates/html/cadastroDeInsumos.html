<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Cadastro dos Insumos</title>
    <link rel="stylesheet" href="../../static/css/style.css">
    <link rel="stylesheet" href="../../static/css/responsivo.css">
    <link rel="shortcut icon" href="../../static/img/logo.png" type="image/x-icon">
    <!-- pequeno script para atualizar unidade ao trocar select -->
    <script defer>
    document.addEventListener('DOMContentLoaded', function () {
        const select = document.getElementById('select-insumo');
        const unidadeEl = document.getElementById('unidade-medida');

        function atualizaUnidade() {
            const opt = select.options[select.selectedIndex];
            const unidade = opt ? opt.dataset.unidade : '';
            unidadeEl.textContent = unidade ? 'Unidade de medida: ' + unidade : '';
        }

        if (select) {
            select.addEventListener('change', atualizaUnidade);
            atualizaUnidade(); // inicializa
        }
    });
    </script>
</head>
<body>
    <header>
        <img src="../../static/img/logo.png" alt="Logo da Lavoro">
        <a class="botao-sair linkUnico" href="{{ url_for('logout') }}">Sair</a>
    </header>

    <main class="d-flex">
        <aside class="fundobarra Tajuste">
            <h4> Funcionalidades </h4>
            <nav class="navegar d-flex">
                <a href="{{ url_for('perfil') }}" class="linksn d-flex">
                    <img src="../../static/img/Pessoa.png" alt="Ícone de pessoa">Perfil
                </a>
                <a href="{{ url_for('insumos') }}" class="linksn d-flex">
                    <img src="../../static/img/carrinho_insumos.png" alt="Ícone de Insumos">Insumos
                </a>
                <a href="{{ url_for('produto') }}" class="linksn d-flex">
                    <img src="../../static/img/caixa_de_produto.png" alt="Ícone da caixa de produtos">Produtos
                </a>
                <a href="{{ url_for('lucro') }}" class="linksn d-flex">
                    <img src="../../static/img/icone_lucratividade.png" alt="Ícone de um saco de dinheiro">Lucratividade
                </a>
            </nav>
        </aside>

        <!-- Form para selecionar insumo(s) e quantidade -->
        <section>
            <!--
               IMPORTANTE: passe uma lista "insumos" do Flask ao renderizar este template.
               Cada insumo pode ser uma tupla/lista: (id_insumo, nome, unidade_medida, custo_unitario, estoque)
            -->
            <div class="selecionar-insumos">
                <h2>Selecione os insumos desejados</h2>

                <!-- Se você quiser adicionar múltiplos insumos, basta clonar esse bloco com JS -->
                <form action="{{ url_for('cadastrarProduto') }}" method="POST">
                    <div class="item">
                        <label for="select-insumo">Insumo</label>
                        <select id="select-insumo" name="id_insumo" class="busca-insumo" required>
                            <option value="" disabled selected>-- escolha um insumo --</option>
                            {% for insumo in insumos %}
                                {# insumo[0]=id, insumo[1]=nome, insumo[2]=unidade_medida #}
                                <option value="{{ insumo[0] }}" data-unidade="{{ insumo[2] }}">{{ insumo[1] }}</option>
                            {% endfor %}
                        </select>

                        <label for="quantidade">Quantidade necessária</label>
                        <input id="quantidade" name="quantidade" type="number" step="0.01" min="0" required
                               placeholder="Ex: 0.50">

                        <p id="unidade-medida" aria-live="polite"></p>
                    </div>

                    <div style="margin-top:1rem;">
                        <button type="submit" class="BotaoVerde">Confirmar</button>
                        <a href="{{ url_for('produto') }}" class="BotaoVermelho" style="margin-left:0.5rem;">Voltar</a>
                    </div>
                </form>
            </div>
        </section>
    </main>

    <footer>
        <div>
            <img src="../../static/img/logo.png" alt="Logo da Lavoro">
            <p>© 2025 Lavoro – Todos os direitos reservados</p>
        </div>
        <div class="contato">
            <div>
                <img src="../../static/img/Icone_localização.png" alt="Ícone de localização">
                <p>Rua Barão do Rio Branco - Birigui/SP</p>
            </div>
            <div>
                <img src="../../static/img/Icone_telefone.png" alt="Ícone de telefone">
                <p>(11) 99999-9999</p>
            </div>
            <div>
                <img src="../../static/img/Caixa_de_email.png" alt="Ícone de email">
                <p>Lavoro@gmail.com</p>
            </div>
        </div>
    </footer>
</body>
</html>
